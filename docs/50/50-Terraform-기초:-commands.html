
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>Terraform 기초: commands</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">Terraform 기초: commands</h2>
                                <div class="box-info">
                                    <p class="category">탐구 생활/Terraform</p>
                                    <p class="date">2024-11-21 21:03:39</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p><figure class="imageblock alignCenter" width="350" height="350" >
    <span data-lightbox="lightbox">
        <img src="./img/Terraform-comamnds.webp" width="350" height="350"  />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16">Terraform는 인프라를 코드로 관리하기 위한 강력한 도구이다. Terraform을 효과적으로 사용하려면 다양한 명령어를 이해하고 활용하는 것이 중요하므로 Terraform에서 자주 사용되는 명령어들과 그 활용 사례에 대해 살펴보자.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
<h2 data-ke-size="size26">주요 Terraform 명령어</h2>
<h3 data-ke-size="size23">1. <code>terraform init</code></h3>
<p data-ke-size="size16"><b><code>terraform init</code></b>은 Terraform 프로젝트를 초기화하는 데 사용된다. 이 명령은 구성 디렉토리를 준비하고 필요한 provider 플러그인을 다운로드한다. Terraform 작업의 첫 단계로 <b>항상 실행해야</b> 한다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">2. <code>terraform validate</code></h3>
<p data-ke-size="size16"><b><code>terraform validate</code></b>는 Terraform 구성 파일의 <b>구문 오류</b>를 확인한다. 이 명령은 코드를 실행하기 전에 구성 파일이 올바른지 검증하는 데 유용하다.</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>성공적인 유효성 검사:결과: "Success! The configuration is valid."</li>
<li><code class="language-bash">terraform validate</code></li>
<li>오류 발생 시:오류가 발생한 줄과 수정 방법이 제공된다.</li>
<li><code class="language-bash">Error: Unsupported argument</code></li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">3. <code>terraform fmt</code></h3>
<p data-ke-size="size16"><b><code>terraform fmt</code></b>는 구성 파일을 표준 형식으로 <b>자동 정렬</b>한다. 이 명령은 코드의 가독성을 높이고, 팀 협업 시 코드 스타일을 통일하는 데 유용하다.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">아래와 같이 포맷이 통일되어 있지 않은 tf 문서가 있는 작업공간에서 terraform fmt 를 실행하면 일관된 포맷으로 만들어준다.</p>
<pre id="code_1732190847140" class="bash" data-ke-language="bash" data-ke-type="codeblock"><code>resource "local_file" "pet" {
filename = var.filename
content  = "${var.content} - ${random_pet.my-pet.id}"
}

resource "random_pet" "my-pet" {
prefix    = var.prefix
            separator = var.separator
                    length    = var.length
}</code></pre>
<pre class="bash" data-ke-language="bash"><code>resource "local_file" "pet" {
  filename = var.filename
  content  = "${var.content} - ${random_pet.my-pet.id}"
}

resource "random_pet" "my-pet" {
  prefix    = var.prefix
  separator = var.separator
  length    = var.length
}</code></pre>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">이때 파일 실행 결과 std out 에 수정된 파일 목록이 출력되며, 변경 사항은 저장된다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">4. <code>terraform plan</code></h3>
<p data-ke-size="size16"><b><code>terraform plan</code></b>은 실행 계획을 생성하여 Terraform이 구성 파일에 정의된 변경 사항을 실제 인프라에 적용하기 전에 어떤 작업이 수행될지 확인할 수 있다.</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>변경 사항이 없다면: "No changes. Infrastructure is up-to-date."</li>
<li>변경 사항이 있다면, 추가/수정/삭제할 리소스 목록이 출력된다.</li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">5. <code>terraform apply</code></h3>
<p data-ke-size="size16"><b><code>terraform apply</code></b>는 <code>terraform plan</code>에서 생성된 실행 계획을 실제 인프라에 <b>적용</b>한다.</p>
<p data-ke-size="size16">명령 실행 후 확인 프롬프트에서 <code>yes</code>를 입력하면 Terraform이 실행 계획을 실행한다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">6. <code>terraform show</code></h3>
<p data-ke-size="size16"><b><code>terraform show</code></b>는 현재 인프라 상태를 표시한다. 이 명령은 Terraform의 상태 파일을 읽어 리소스의 속성을 출력한다.</p>
<pre class="dart"><code>terraform show</code></pre>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>JSON 형식으로 출력하려면:
<pre class="pgsql"><code>terraform show -json</code></pre>
</li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">7. <code>terraform output</code></h3>
<p data-ke-size="size16"><b><code>terraform output</code></b>은 구성 파일에서 정의된 <b>출력 변수</b>의 값을 표시합니다.</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>모든 출력 변수 표시:
<pre class="ebnf"><code>terraform output</code></pre>
</li>
<li>특정 변수의 값 표시:
<pre class="xml"><code>terraform output &lt;variable_name&gt;</code></pre>
</li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">8. <code>terraform refresh</code></h3>
<p data-ke-size="size16"><b><code>terraform refresh</code></b>는 실제 인프라 상태를 <b>동기화</b>하고 Terraform의 상태 파일을 업데이트합니다. 수동으로 외부에서 리소스가 변경된 경우 유용하다.</p>
<pre class="angelscript"><code>terraform refresh</code></pre>
<p data-ke-size="size16">이 명령은 <code>terraform plan</code> 및 <code>terraform apply</code> 실행 시 자동으로 수행되지만, <code>-refresh=false</code> 플래그를 사용하면 이를 건너뛸 수 있다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">9. <code>terraform graph</code></h3>
<p data-ke-size="size16"><b><code>terraform graph</code></b>는 Terraform 구성 파일 또는 실행 계획에 정의된 <b>의존성 그래프</b>를 생성한다.</p>
<p data-ke-size="size16">위의 fmt 에서 사용된 파일을 예시로 사용해보면 사람이 해석하기에는 다소 난해한 DOT 형식의 텍스트를 출력한다.&nbsp;</p>
<pre id="code_1732191073864" class="bash" data-ke-language="bash" data-ke-type="codeblock"><code>➜  terraform-files terraform graph
digraph {
        compound = "true"
        newrank = "true"
        subgraph "root" {
                "[root] local_file.pet (expand)" [label = "local_file.pet", shape = "box"]
                "[root] provider[\"registry.terraform.io/hashicorp/local\"]" [label = "provider[\"registry.terraform.io/hashicorp/local\"]", shape = "diamond"]
                ...
        }
}</code></pre>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">이러한 텍스트를 그래프 시각화 도구에 파이프라인으로 연결하면 시각화된 그래프를 볼 수 있다. mac 과 linux 에서는 Graphviz 를 이용할 수 있겠다.&nbsp;</p>
<pre class="bash" data-ke-language="bash"><code>terraform graph | dot -Tpng &gt; graph.png</code></pre>
<p data-ke-size="size16">아래가 그 결과인데, 그다지 보기 좋진 않다.</p>
<p><figure class="imageblock alignCenter" >
    <span data-lightbox="lightbox">
        <img src="./img/graph.png"  />
    </span>
    <figcaption></figcaption>
</figure></p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">10. <code>terraform providers</code></h3>
<p data-ke-size="size16"><b><code>terraform providers</code></b>는 현재 구성 파일에서 사용하는 <b>provider 목록</b>을 표시한다.</p>
<pre class="ebnf"><code>terraform providers</code></pre>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">필요한 provider 플러그인을 다른 디렉토리에 복사하려면 <code>mirror</code> 서브 명령을 사용할 수 있다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">11. <code>terraform state</code></h3>
<p data-ke-size="size16">Terraform 상태 파일을 직접 수정하는 대신, <b><code>terraform state</code></b> 명령어를 사용하여 안전하게 상태 파일을 관리할 수 있다. 이 명령은 상태 파일에서 리소스를 이동하거나 수정하는 데 사용된다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5" />
<h2 data-ke-size="size26">Terraform 명령어 사용 팁</h2>
<h3 data-ke-size="size23">1. 협업 환경에서의 Remote State</h3>
<p data-ke-size="size16">팀 환경에서는 <b>Remote State</b>를 사용하여 상태 파일을 공유하는 것이 중요하다. Terraform 상태 파일을 원격 스토리지(예: AWS S3, Terraform Cloud)에 저장하면, 모든 팀원이 항상 최신 상태를 유지할 수 있다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">2. 자동화된 워크플로우</h3>
<p data-ke-size="size16">Terraform 명령어를 CI/CD 파이프라인에 통합하면 인프라 배포를 자동화할 수 있다. <code>terraform init</code>, <code>plan</code>, <code>apply</code>를 순서대로 실행하여 안전한 배포를 구현할 수 있겠다.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style6" />
<h3 data-ke-size="size23">3. <code>-refresh=false</code>로 성능 최적화</h3>
<p data-ke-size="size16">대규모 인프라에서는 <code>-refresh=false</code> 옵션을 사용하여 불필요한 상태 동기화를 줄이고 실행 속도를 개선할 수 있다.</p>
                        </div>
                        <br/>
                        <div class="tags">
                            #Terraform #terraform command 
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
